{% load i18n %}{% load url from future %}

  <div class="row">
    <div class="col-lg-12">
      <div class="panel panel-default">
        <div class="panel-heading">{{ ticket.ticket }} . {{ ticket.title }} [{{ ticket.get_status }}]
<span class='ticket_toolbar'>
    {% if helpdesk_settings.HELPDESK_SHOW_EDIT_BUTTON_TICKET_TOP %}
        <a href='{% url 'helpdesk_edit' ticket.id %}' class="ticket-edit"><img src='{{ STATIC_URL }}helpdesk/buttons/edit.png' alt='Edit' title='Edit' width='60' height='15' /></a>
    {% endif %}
    {% if helpdesk_settings.HELPDESK_SHOW_DELETE_BUTTON_TICKET_TOP %}
    <a href='{% url 'helpdesk_delete' ticket.id %}' class="ticket-delete"><img src='{{ STATIC_URL }}helpdesk/buttons/delete.png' alt='Delete' title='Delete' width='60' height='15' /></a>
    {% endif %}
    {% if helpdesk_settings.HELPDESK_SHOW_HOLD_BUTTON_TICKET_TOP %}
    {% if ticket.on_hold %}<a href='unhold/' class="ticket-hold">{% trans "Unhold" %}</a>{% else %}<a href='hold/' class="ticket-hold">{% trans "Hold" %}</a>{% endif %}
    {% endif %}</span>

        </div>     
        <table class="table table-condensed">
          <tbody>
            <tr>
              <td>{% trans 'Queue' %}</td>
              <td>{% blocktrans with ticket.queue as queue_name %}{{ queue_name }}{%endblocktrans %}</td>
            </tr>
            <tr>
              <td>{% trans 'Submitted On' %}</td>
              <td>{{ ticket.created|date:"r" }} ({{ ticket.created|timesince }} ago)</td>
            </tr>
            <tr>
              <td>{% trans 'Submitter E-Mail' %}</td>
              <td>{{ ticket.submitter_email }}</td>
            </tr>
            <tr>
              <td>{% trans 'Assigned To' %}</td>
              <td>
              {{ ticket.get_assigned_to }}{% ifequal ticket.get_assigned_to _('Unassigned') %} 
              <strong><a href='?take'><span class='button button_take'>{% trans "Take" %}</span></a></strong>{% endifequal %}
              </td>
            </tr>
            <tr>
              <td>{% trans 'Copies To' %}</td>
              <td>
                {{ ticketcc_string }} 
                <a data-toggle="tooltip" href="{% url 'helpdesk_ticket_cc' ticket.id %}" data-original-title="{% trans 'Click here to add / remove people who should receive an e-mail whenever this ticket is updated.' %}">
                        {% trans "Manage" %}
                </a>
                {% if SHOW_SUBSCRIBE %} | 
                <a data-toggle='tooltip' href='?subscribe' data-original-title="{% trans 'Click here to subscribe yourself to this ticket, if you want to receive an e-mail whenever this ticket is updated.' %}">{% trans "Subscribe" %}
                </a>
                {% endif %}
               </td>
            </tr>

            <tr>
              <td>{% trans 'Priority' %}</td>
              <td>{{ ticket.get_priority_display }}</td>
            </tr>

            {% if tags_enabled %}
              <tr>
                <td>{% trans 'Tags' %}</td>
                <td>{{ ticket.tags }}</td>
              </tr>
            {% endif %}

            <tr>
                <td>{% trans "Dependencies" %}</td>
                <td>{% for dep in ticket.ticketdependency.all %}
        {% if forloop.first %}<p>{% trans "This ticket cannot be resolved until the following ticket(s) are resolved" %}</p><ul>{% endif %}
            <li><a href='{{ dep.depends_on.get_absolute_url }}'>{{ dep.depends_on.ticket }} {{ dep.depends_on.title }}</a> ({{ dep.depends_on.get_status_display }}) <a href='{% url 'helpdesk_ticket_dependency_del' ticket.id dep.id %}'>{% trans "Remove Dependency" %}</a></li>
        {% if forloop.last %}</ul>{% endif %}
        {% empty %}
        <i>{% trans "This ticket has no dependencies." %}</i>
        {% endfor %}
        <p><a class='tooltip' href='{% url 'helpdesk_ticket_dependency_add' ticket.id %}'>{% trans "Add Dependency" %}<span>{% trans "Click on 'Add Dependency', if you want to make this ticket dependent on another ticket. A ticket may not be closed until all tickets it depends on are closed." %}</span></a></p>
                </td>
            </tr>

        {% for customfield in ticket.ticketcustomfieldvalue_set.all %}
        <tr>
            <td>{{ customfield.field.label }}</td>
            <td>
            {% ifequal customfield.field.data_type "url" %}
              <a href='{{ customfield.value }}'>{{ customfield.value }}</a>
            {% else %}
              {{ customfield.value }}
            {% endifequal %}
            </td>
        </tr>
        {% endfor %}

            <tr>
              <td>{% trans "Description" %}</td>
              <td>{{ ticket.description|force_escape|urlizetrunc:50|linebreaksbr }}</td>
            </tr>
            {% if ticket.resolution %}
              <tr>
                <td>{% trans "Resolution" %}</td>
                <td>{{ ticket.resolution|urlizetrunc:50|linebreaksbr }}
                  {% ifequal ticket.get_status_display 'Resolved' %}
                    <hr>
                    <a href="{{ ticket.ticket_url }}&close">
                      <img src="{{ STATIC_URL }}/helpdesk/buttons/accept.png" alt="{% trans 'Accept' %}" title="{% trans 'Accept and Close' %}" width="60" height="15">
                    </a>
                  {% endifequal %}
                </td>
              </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
